# 요구사항 분석

## 요구사항

- 아래 2가지 API 를 구현합니다.
    - 특강 신청 API
    - 특강 신청 여부 조회 API
- 각 기능 및 제약 사항에 대해 단위 테스트를 반드시 하나 이상 작성하도록 합니다.
- **다수의 인스턴스로 어플리케이션이 동작하더라도 기능에 문제가 없도록 작성**하도록 합니다.
- 동시성 이슈를 고려 하여 구현합니다.
- **DB 는 MySQL / MariaDB 로 제한합니다.**
- **Test 는 (1) 인메모리 DB (2) docker-compose 정도 허용합니다. ( + TestContainers 이용해도 됨 )**
- @Entity와 도메인 모델의 분리는 금지합니다.

### API Specs

#### 1️⃣ **(핵심) 특강 신청 API**

- 특정 userId 로 선착순으로 제공되는 특강을 신청하는 API 를 작성합니다.
- 동일한 신청자는 동일한 강의에 대해서 한 번의 수강 신청만 성공할 수 있습니다.
- 특강은 선착순 30명만 신청 가능합니다.
- 이미 신청자가 30명이 초과 되면 이후 신청자는 요청을 실패합니다.

##### 분석

- 특강을 신청하는 것이므로 신청일 이후 날짜만 신청할 수 있다. (가정)
- 특강 신청 시 고려해야 할 항목 (RDBMS 레벨의 동시성 처리)
    - 특강의 정원을 초과하면 안된다. `(STEP 3)`
        - 동시에 동일한 특강에 대해 40명이 신청했을 때, 30명만 성공하는 것을 검증하는 **통합 테스트** 작성
    - 같은 사용자는 동일한 특강은 한 번만 신청할 수 있다. `(STEP 4)`
        - 동일한 유저 정보로 같은 특강을 5번 신청했을 때, 1번만 성공하는 것을 검증하는 **통합 테스트** 작성

#### 2️⃣ **특강 신청 가능 목록 API**

- 날짜별로 현재 신청 가능한 특강 목록을 조회하는 API 를 작성합니다.
- 특강의 정원은 30명으로 고정이며, 사용자는 각 특강에 신청하기 전 목록을 조회해 볼 수 있어야 합니다.

##### 분석

- 날짜별로 현재 신청 가능한 특강이 여러 개 존재해야 한다.
- **특강 시작 시간** 기준으로 특강 목록을 보여준다.
- 특강 신청 완료 목록 조회에 강연자 정보가 존재하므로, 신청 가능 목록에서도 강연자 정보를 보여준다.

#### 3️⃣ **특강 신청 완료 목록 조회 API**

- 특정 userId 로 신청 완료된 특강 목록을 조회하는 API 를 작성합니다.
- 각 항목은 특강 ID 및 이름, 강연자 정보를 담고 있어야 합니다.

##### 분석

- 특강에는 강연자가 필요하다.

---

### 도메인 설계

1. Lecture (특강)
    - id (특강 ID)
    - name (특강 이름)
    - lecturerId (강연자 ID)
    - subscription_count (특강 신청자 수)
    - startTime (특강 시작 시간)
    - endTime (특강 종료 시간)
2. Lecturer (강연자)
    - id (강연자 ID)
    - name (강연자 이름)
3. LectureSubscription (특강 신청)
    - id (특강 신청 ID)
    - lectureId (특강 ID)
    - userId (사용자 ID)
    - createdAt (특강 신청 시각)
4. User (사용자)
    - id (사용자 ID)
    - name (사용자 이름)